OBJECT Codeunit 358 DateFilter-Calc
{
  OBJECT-PROPERTIES
  {
    Date=25/10/16;
    Time=12:00:00;
    Version List=NAVW110.00,NAVGB10.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ConvertToUtcDateTime@5(LocalDateTime@1000 : DateTime) : DateTime;
    VAR
      DotNetDateTimeOffset@1002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTimeOffset";
      DotNetDateTimeOffsetNow@1001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTimeOffset";
    BEGIN
      IF LocalDateTime = CREATEDATETIME(0D,0T) THEN
        EXIT(CREATEDATETIME(0D,0T));

      DotNetDateTimeOffset := DotNetDateTimeOffset.DateTimeOffset(LocalDateTime);
      DotNetDateTimeOffsetNow := DotNetDateTimeOffset.Now;
      EXIT(DotNetDateTimeOffset.LocalDateTime - DotNetDateTimeOffsetNow.Offset);
    END;

    BEGIN
    END.
  }
}

