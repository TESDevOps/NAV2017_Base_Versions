OBJECT Page 132 Posted Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=04/08/17;
    Time=12:00:00;
    Version List=NAVW110.00.00.17972,NAVGB10.00.00.17972;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Sales Invoice;
               ENG=Posted Sales Invoice];
    InsertAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table112;
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Invoice,Correct;
                                ENG=New,Process,Report,Invoice,Correct];
    OnInit=BEGIN
             DocExcStatusVisible := TRUE;
           END;

    OnOpenPage=VAR
                 CRMIntegrationManagement@1000 : Codeunit 5330;
                 OfficeMgt@1001 : Codeunit 1630;
               BEGIN
                 SetSecurityFilterOnRespCenter;
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
               END;

    OnAfterGetRecord=BEGIN
                       DocExchStatusStyle := GetDocExchStatusStyle;
                     END;

    OnAfterGetCurrRecord=VAR
                           IncomingDocument@1000 : Record 130;
                           CRMCouplingManagement@1001 : Codeunit 5331;
                         BEGIN
                           HasIncomingDocument := IncomingDocument.PostedDocExists("No.","Posting Date");
                           DocExchStatusStyle := GetDocExchStatusStyle;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CRMIsCoupledToRecord := CRMIntegrationEnabled AND CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                           UpdatePaymentService;
                           DocExcStatusVisible := DocExchangeStatusIsSent;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 55      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 ENG=&Invoice];
                      Image=Invoice }
      { 8       ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 ENG=Statistics];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 ENG=View statistical information, such as the value of posted entries, for the record.];
                      RunObject=Page 397;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category4 }
      { 57      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 ENG=Co&mments];
                      ToolTipML=[ENU=View or add notes about the posted sales invoice.;
                                 ENG=View or add notes about the posted sales invoice.];
                      RunObject=Page 67;
                      RunPageLink=Document Type=CONST(Posted Invoice),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category4 }
      { 89      ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 ENG=Dimensions];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 ENG=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyse transaction history.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 112     ;2   ;Action    ;
                      AccessByPermission=TableData 456=R;
                      CaptionML=[ENU=Approvals;
                                 ENG=Approvals];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 ENG=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approvals;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ShowPostedApprovalEntries(RECORDID);
                               END;
                                }
      { 171     ;2   ;Separator  }
      { 35      ;2   ;Action    ;
                      Name=ChangePaymentService;
                      CaptionML=[ENU=Change Payment Service;
                                 ENG=Change Payment Service];
                      ToolTipML=[ENU=Change or add the payment service, such as PayPal Standard, that will be included on the sales document so the customer can quickly access the payment site.;
                                 ENG=Change or add the payment service, such as PayPal Standard, that will be included on the sales document so the customer can quickly access the payment site.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=PaymentServiceVisible;
                      PromotedIsBig=Yes;
                      Image=ElectronicPayment;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 PaymentServiceSetup@1000 : Record 1060;
                               BEGIN
                                 PaymentServiceSetup.ChangePaymentServicePostedInvoice(Rec);
                               END;
                                }
      { 45      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 ENG=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 43      ;2   ;Action    ;
                      Name=CRMGotoInvoice;
                      CaptionML=[ENU=Invoice;
                                 ENG=Invoice];
                      ToolTipML=[ENU=Open the coupled Microsoft Dynamics CRM account.;
                                 ENG=Open the coupled Microsoft Dynamics CRM account.];
                      ApplicationArea=#All;
                      Enabled=CRMIsCoupledToRecord;
                      Image=CoupledSalesInvoice;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=CreateInCRM;
                      CaptionML=[ENU=Create Invoice in Dynamics CRM;
                                 ENG=Create Invoice in Dynamics CRM];
                      ToolTipML=[ENU=Create a sales invoice in Dynamics CRM that is connected to this posted sales invoice.;
                                 ENG=Create a sales invoice in Dynamics CRM that is connected to this posted sales invoice.];
                      ApplicationArea=#All;
                      Enabled=NOT CRMIsCoupledToRecord;
                      Image=NewSalesInvoice;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.CreateNewRecordInCRM(RECORDID,FALSE);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 5       ;1   ;Action    ;
                      Name=SendCustom;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send;
                                 ENG=Send];
                      ToolTipML=[ENU=Prepare to send the document according to the customer's sending profile, such as attached to an email. The Send document to window opens first so you can confirm or select a sending profile.;
                                 ENG=Prepare to send the document according to the customer's sending profile, such as attached to an email. The Send document to window opens first so you can confirm or select a sending profile.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendToMultiple;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 SalesInvHeader@1000 : Record 112;
                               BEGIN
                                 SalesInvHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.SendRecords;
                               END;
                                }
      { 58      ;1   ;Action    ;
                      Name=Print;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 ENG=&Print];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 ENG=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SalesInvHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.PrintRecords(TRUE);
                               END;
                                }
      { 9       ;1   ;Action    ;
                      Name=Email;
                      CaptionML=[ENU=&Email;
                                 ENG=&Email];
                      ToolTipML=[ENU=Prepare to email the document. The Send Email window opens prefilled with the customer's email address so you can add or edit information.;
                                 ENG=Prepare to email the document. The Send Email window opens prefilled with the customer's email address so you can add or edit information.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Email;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SalesInvHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.EmailRecords(TRUE);
                               END;
                                }
      { 59      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 ENG=&Navigate];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 ENG=Find all entries and documents that exist for the document number and posting date on the selected entry or document.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=NOT IsOfficeAddin;
                      Image=Navigate;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 13      ;1   ;Action    ;
                      Name=ActivityLog;
                      CaptionML=[ENU=Activity Log;
                                 ENG=Activity Log];
                      ToolTipML=[ENU=View the status and any errors if the document was sent as an electronic document or OCR file through the document exchange service.;
                                 ENG=View the status and any errors if the document was sent as an electronic document or OCR file through the document exchange service.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Log;
                      OnAction=BEGIN
                                 ShowActivityLog;
                               END;
                                }
      { 23      ;1   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 ENG=Incoming Document];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 21      ;2   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 ENG=View Incoming Document];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 ENG=View any incoming document records and file attachments that exist for the entry or document.];
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCard("No.","Posting Date");
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 ENG=Select Incoming Document];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 ENG=Select an incoming document record and file attachment that you want to link to the entry or document.];
                      Enabled=NOT HasIncomingDocument;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.SelectIncomingDocumentForPostedDocument("No.","Posting Date",RECORDID);
                               END;
                                }
      { 17      ;2   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 ENG=Create Incoming Document from File];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 ENG=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.];
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPostedDocument("No.","Posting Date");
                               END;
                                }
      { 41      ;1   ;ActionGroup;
                      CaptionML=[ENU=Correct;
                                 ENG=Correct] }
      { 39      ;2   ;Action    ;
                      Name=CorrectInvoice;
                      CaptionML=[ENU=Correct;
                                 ENG=Correct];
                      ToolTipML=[ENU=Reverse this posted invoice and automatically create a new invoice with the same information that you can correct before posting. This posted invoice will automatically be canceled.;
                                 ENG=Reverse this posted invoice and automatically create a new invoice with the same information that you can correct before posting. This posted invoice will automatically be cancelled.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Undo;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 CorrectPstdSalesInvYesNo@1000 : Codeunit 1322;
                               BEGIN
                                 IF CorrectPstdSalesInvYesNo.CorrectInvoice(Rec) THEN
                                   CurrPage.CLOSE;
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=CancelInvoice;
                      CaptionML=[ENU=Cancel;
                                 ENG=Cancel];
                      ToolTipML=[ENU=Create and post a sales credit memo that reverses this posted sales invoice. This posted sales invoice will be canceled.;
                                 ENG=Create and post a sales credit memo that reverses this posted sales invoice. This posted sales invoice will be cancelled.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 CancelPstdSalesInvYesNo@1000 : Codeunit 1323;
                               BEGIN
                                 IF CancelPstdSalesInvYesNo.CancelInvoice(Rec) THEN
                                   CurrPage.CLOSE;
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=CreateCreditMemo;
                      CaptionML=[ENU=Create Corrective Credit Memo;
                                 ENG=Create Corrective Credit Memo];
                      ToolTipML=[ENU=Create a credit memo for this posted invoice that you complete and post manually to reverse the posted invoice.;
                                 ENG=Create a credit memo for this posted invoice that you complete and post manually to reverse the posted invoice.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CreateCreditMemo;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 SalesHeader@1001 : Record 36;
                                 CorrectPostedSalesInvoice@1000 : Codeunit 1303;
                               BEGIN
                                 CorrectPostedSalesInvoice.CreateCreditMemoCopyDocument(Rec,SalesHeader);
                                 PAGE.RUN(PAGE::"Sales Credit Memo",SalesHeader);
                                 CurrPage.CLOSE;
                               END;
                                }
      { 51      ;1   ;ActionGroup;
                      CaptionML=[ENU=Invoice;
                                 ENG=Invoice];
                      Image=Invoice }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Customer;
                                 ENG=Customer];
                      ToolTipML=[ENU=View or edit detailed information about the customer.;
                                 ENG=View or edit detailed information about the customer.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 21;
                      RunPageLink=No.=FIELD(Sell-to Customer No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Customer;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes }
      { 47      ;2   ;Action    ;
                      Name=ShowCreditMemo;
                      CaptionML=[ENU=Show Canceled/Corrective Credit Memo;
                                 ENG=Show Cancelled/Corrective Credit Memo];
                      ToolTipML=[ENU=Open the posted sales credit memo that was created when you canceled the posted sales invoice. If the posted sales invoice is the result of a canceled sales credit memo, then canceled sales credit memo will open.;
                                 ENG=Open the posted sales credit memo that was created when you cancelled the posted sales invoice. If the posted sales invoice is the result of a cancelled sales credit memo, then cancelled sales credit memo will open.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=Cancelled OR Corrective;
                      Image=CreditMemo;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrCrMemo;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           ENG=General] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posted invoice number.;
                           ENG=Specifies the posted invoice number.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 61  ;2   ;Field     ;
                CaptionML=[ENU=Customer;
                           ENG=Customer];
                ToolTipML=[ENU=Specifies the name of the customer that you shipped the items on the invoice to.;
                           ENG=Specifies the name of the customer that you shipped the items on the invoice to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer Name";
                TableRelation=Customer.Name;
                Importance=Promoted;
                Editable=FALSE }

    { 4   ;2   ;Group     ;
                CaptionML=[ENU=Sell-to;
                           ENG=Sell-to];
                GroupType=Group }

    { 63  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           ENG=Address];
                ToolTipML=[ENU=Specifies the address of the customer that the items on the invoice were shipped to.;
                           ENG=Specifies the address of the customer that the items on the invoice were shipped to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address";
                Importance=Additional;
                Editable=FALSE }

    { 65  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           ENG=Address 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           ENG=Specifies additional address information.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 1040000;3;Field     ;
                CaptionML=[ENU=City;
                           ENG=City];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to City";
                Importance=Additional;
                Editable=FALSE }

    { 1040002;3;Field     ;
                CaptionML=[ENU=County;
                           ENG=County];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to County";
                Importance=Additional;
                Editable=FALSE }

    { 6   ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           ENG=Postcode];
                ToolTipML=[ENU=Specifies the postal code.;
                           ENG=Specifies the postcode.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 96  ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           ENG=Contact No.];
                ToolTipML=[ENU=Specifies the number of the contact that the invoice was sent to.;
                           ENG=Specifies the number of the contact that the invoice was sent to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 69  ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           ENG=Contact];
                ToolTipML=[ENU=Specifies the name of the person to contact when you communicate with the customer who you shipped the items to.;
                           ENG=Specifies the name of the person to contact when you communicate with the customer who you shipped the items to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact";
                Editable=FALSE }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which you created the sales document.;
                           ENG=Specifies the date on which you created the sales document.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the invoice was posted.;
                           ENG=Specifies the date on which the invoice was posted.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Editable=FALSE }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the invoice is due for payment.;
                           ENG=Specifies the date on which the invoice is due for payment.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Promoted;
                Editable=FALSE }

    { 3   ;2   ;Group     ;
                Visible=DocExcStatusVisible;
                GroupType=Group }

    { 27  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the document if you are using a document exchange service to send it as an electronic document. The status values are reported by the document exchange service.;
                           ENG=Specifies the status of the document if you are using a document exchange service to send it as an electronic document. The status values are reported by the document exchange service.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Exchange Status";
                Importance=Additional;
                Editable=FALSE;
                StyleExpr=DocExchStatusStyle;
                OnDrillDown=VAR
                              DocExchServDocStatus@1000 : Codeunit 1420;
                            BEGIN
                              DocExchServDocStatus.DocExchStatusDrillDown(Rec);
                            END;
                             }

    { 114 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales quote document if a quote was used to start the sales process.;
                           ENG=Specifies the number of the sales quote document if a quote was used to start the sales process.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Quote No." }

    { 86  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales order that this invoice was posted from.;
                           ENG=Specifies the number of the sales order that this invoice was posted from.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order No.";
                Importance=Promoted;
                Editable=FALSE }

    { 73  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales document that the posted invoice was created for.;
                           ENG=Specifies the number of the sales document that the posted invoice was created for.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pre-Assigned No.";
                Importance=Additional;
                Editable=FALSE }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the external document number that is entered on the sales header that this line was posted from.;
                           ENG=Specifies the external document number that is entered on the sales header that this line was posted from.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No.";
                Importance=Additional;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which salesperson is associated with the invoice.;
                           ENG=Specifies which salesperson is associated with the invoice.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                Importance=Additional;
                Editable=FALSE }

    { 92  ;2   ;Field     ;
                AccessByPermission=TableData 5714=R;
                ToolTipML=[ENU=Specifies the code of the responsibility center associated with the user who created the invoice, your company, or the customer in the sales invoice.;
                           ENG=Specifies the code of the responsibility centre associated with the user who created the invoice, your company, or the customer in the sales invoice.];
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the invoice has been printed.;
                           ENG=Specifies how many times the invoice has been printed.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. Printed";
                Importance=Additional;
                Editable=FALSE }

    { 77  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted sales invoice has been either corrected or canceled.;
                           ENG=Specifies if the posted sales invoice has been either corrected or cancelled.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveCreditMemo;
                            END;
                             }

    { 102 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted sales invoice is a corrective document.;
                           ENG=Specifies if the posted sales invoice is a corrective document.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledCreditMemo;
                            END;
                             }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted invoice is paid. The check box will also be selected if a credit memo for the remaining amount has been applied.;
                           ENG=Specifies if the posted invoice is paid. The check box will also be selected if a credit memo for the remaining amount has been applied.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Closed;
                Importance=Promoted }

    { 83  ;2   ;Group     ;
                CaptionML=[ENU=Work Description;
                           ENG=Work Description];
                GroupType=Group }

    { 82  ;3   ;Field     ;
                SourceExpr=GetWorkDescription;
                Importance=Additional;
                Editable=FALSE;
                MultiLine=Yes;
                ShowCaption=No }

    { 54  ;1   ;Part      ;
                Name=SalesInvLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page133 }

    { 16  ;1   ;Group     ;
                CaptionML=[ENU=Invoice Details;
                           ENG=Invoice Details];
                GroupType=Group }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code of the invoice.;
                           ENG=Specifies the currency code of the invoice.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 MODIFY;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the shipment date. It is copied from the Shipment Date field on the sales header and is used for planning purposes.;
                           ENG=Specifies the shipment date. It is copied from the Shipment Date field on the sales header and is used for planning purposes.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Date";
                Importance=Promoted;
                Editable=FALSE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the sales document.;
                           ENG=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the sales document.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted;
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how the customer must pay for products on the sales document.;
                           ENG=Specifies how the customer must pay for products on the sales document.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional;
                Editable=FALSE }

    { 15  ;2   ;Group     ;
                Visible=PaymentServiceVisible;
                GroupType=Group }

    { 64  ;3   ;Field     ;
                Name=SelectedPayments;
                CaptionML=[ENU=Payment Service;
                           ENG=Payment Service];
                ToolTipML=[ENU=Specifies the payment service, such as PayPal, that the sales invoice can be paid with.;
                           ENG=Specifies the payment service, such as PayPal, that the sales invoice can be paid with.];
                ApplicationArea=#All;
                SourceExpr=GetSelectedPaymentsText;
                Enabled=PaymentServiceEnabled;
                Editable=FALSE;
                MultiLine=Yes;
                OnAssistEdit=VAR
                               PaymentServiceSetup@1000 : Record 1060;
                             BEGIN
                               PaymentServiceSetup.ChangePaymentServicePostedInvoice(Rec);
                               CurrPage.UPDATE(FALSE);
                             END;
                              }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the invoice.;
                           ENG=Specifies the dimension value code associated with the invoice.];
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the invoice.;
                           ENG=Specifies the dimension value code associated with the invoice.];
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percentage granted if payment is made by the date entered in the Pmt. Discount Date field.;
                           ENG=Specifies the payment discount percentage granted if payment is made by the date entered in the Pmt. Discount Date field.];
                SourceExpr="Payment Discount %";
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date by which the invoice must be paid to obtain a payment discount.;
                           ENG=Specifies the date by which the invoice must be paid to obtain a payment discount.];
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Editable=FALSE }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the direct-debit mandate that the customer has signed to allow direct debit collection of payments.;
                           ENG=Specifies the direct-debit mandate that the customer has signed to allow direct debit collection of payments.];
                SourceExpr="Direct Debit Mandate ID";
                Editable=FALSE }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the location from which the items were shipped.;
                           ENG=Specifies the code for the location from which the items were shipped.];
                SourceExpr="Location Code";
                Importance=Additional;
                Editable=FALSE }

    { 53  ;1   ;Group     ;
                CaptionML=[ENU=Shipping and Billing;
                           ENG=Shipping and Billing];
                GroupType=Group }

    { 80  ;2   ;Group     ;
                CaptionML=[ENU=Shipping Details;
                           ENG=Shipping Details];
                GroupType=Group }

    { 71  ;3   ;Field     ;
                CaptionML=[ENU=Method;
                           ENG=Method];
                ToolTipML=[ENU=Specifies the code that represents the shipment method for the invoice.;
                           ENG=Specifies the code that represents the shipment method for the invoice.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Method Code";
                Importance=Additional;
                Editable=FALSE }

    { 79  ;3   ;Field     ;
                CaptionML=[ENU=Agent;
                           ENG=Agent];
                ToolTipML=[ENU=Specifies which shipping agent is used to transport the items on the sales document to the customer.;
                           ENG=Specifies which shipping agent is used to transport the items on the sales document to the customer.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Importance=Additional;
                Editable=FALSE }

    { 81  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the shipping agent's package number.;
                           ENG=Specifies the shipping agent's package number.];
                ApplicationArea=#Suite;
                SourceExpr="Package Tracking No.";
                Importance=Additional;
                Editable=FALSE }

    { 1905885101;2;Group  ;
                CaptionML=[ENU=Ship-to;
                           ENG=Ship-to];
                GroupType=Group }

    { 56  ;3   ;Field     ;
                CaptionML=[ENU=Address Code;
                           ENG=Address Code];
                ToolTipML=[ENU=Specifies the address on purchase orders shipped with a drop shipment directly from the vendor to a customer.;
                           ENG=Specifies the address on purchase orders shipped with a drop shipment directly from the vendor to a customer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Code";
                Importance=Promoted;
                Editable=FALSE }

    { 46  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           ENG=Name];
                ToolTipML=[ENU=Specifies the name of the customer that the items were shipped to.;
                           ENG=Specifies the name of the customer that the items were shipped to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 42  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           ENG=Address];
                ToolTipML=[ENU=Specifies the address that the items on the invoice were shipped to.;
                           ENG=Specifies the address that the items on the invoice were shipped to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           ENG=Postcode];
                ToolTipML=[ENU=Specifies the postal code.;
                           ENG=Specifies the postcode.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           ENG=City];
                ToolTipML=[ENU=Specifies the city the items on the invoice were shipped to.;
                           ENG=Specifies the city the items on the invoice were shipped to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 1040010;3;Field     ;
                CaptionML=[ENU=County;
                           ENG=County];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 36  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           ENG=Contact];
                ToolTipML=[ENU=Specifies the name of the person you regularly contact at the address that the items were shipped to.;
                           ENG=Specifies the name of the person you regularly contact at the address that the items were shipped to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 60  ;2   ;Group     ;
                CaptionML=[ENU=Bill-to;
                           ENG=Bill-to];
                GroupType=Group }

    { 18  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           ENG=Name];
                ToolTipML=[ENU=Specifies the name of the customer that the invoice was sent to.;
                           ENG=Specifies the name of the customer that the invoice was sent to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Name";
                Importance=Promoted;
                Editable=FALSE }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           ENG=Address];
                ToolTipML=[ENU=Specifies the address of the customer that the invoice was sent to.;
                           ENG=Specifies the address of the customer that the invoice was sent to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address";
                Importance=Additional;
                Editable=FALSE }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           ENG=Address 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           ENG=Specifies additional address information.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 1040004;3;Field     ;
                CaptionML=[ENU=City;
                           ENG=City];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to City";
                Importance=Additional;
                Editable=FALSE }

    { 1040006;3;Field     ;
                CaptionML=[ENU=County;
                           ENG=County];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to County";
                Importance=Additional;
                Editable=FALSE }

    { 78  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           ENG=Postcode];
                ToolTipML=[ENU=Specifies the postal code.;
                           ENG=Specifies the postcode.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 98  ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           ENG=Contact No.];
                ToolTipML=[ENU=Specifies the number of the contact the invoice was sent to.;
                           ENG=Specifies the number of the contact the invoice was sent to.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           ENG=Contact];
                ToolTipML=[ENU=Specifies the name of the person you regularly contact when you communicate with the customer to whom the invoice was sent.;
                           ENG=Specifies the name of the person you regularly contact when you communicate with the customer to whom the invoice was sent.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Contact";
                Editable=FALSE }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           ENG=Foreign Trade] }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the invoice was part of an EU 3-party trade transaction.;
                           ENG=Specifies whether the invoice was part of an EU 3-party trade transaction.];
                SourceExpr="EU 3-Party Trade";
                Editable=FALSE }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transaction specification that was used in the invoice.;
                           ENG=Specifies the transaction specification that was used in the invoice.];
                SourceExpr="Transaction Specification";
                Editable=FALSE }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transport method of the sales header that this line was posted from.;
                           ENG=Specifies the transport method of the sales header that this line was posted from.];
                SourceExpr="Transport Method";
                Editable=FALSE }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the port of exit through which you shipped the items out of your country/region.;
                           ENG=Specifies the code of the port of exit through which you shipped the items out of your country/region.];
                SourceExpr="Exit Point";
                Editable=FALSE }

    { 75  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the area code used in the invoice.;
                           ENG=Specifies the area code used in the invoice.];
                SourceExpr=Area;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 11  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesInvHeader@1000 : Record 112;
      ChangeExchangeRate@1001 : Page 511;
      HasIncomingDocument@1002 : Boolean;
      DocExchStatusStyle@1003 : Text;
      CRMIntegrationEnabled@1004 : Boolean;
      CRMIsCoupledToRecord@1005 : Boolean;
      PaymentServiceVisible@1007 : Boolean;
      PaymentServiceEnabled@1008 : Boolean;
      DocExcStatusVisible@1006 : Boolean;
      IsOfficeAddin@1009 : Boolean;

    LOCAL PROCEDURE UpdatePaymentService@7();
    VAR
      PaymentServiceSetup@1000 : Record 1060;
    BEGIN
      PaymentServiceVisible := PaymentServiceSetup.IsPaymentServiceVisible;
      PaymentServiceEnabled := PaymentServiceSetup.CanChangePaymentService(Rec);
    END;

    BEGIN
    END.
  }
}

